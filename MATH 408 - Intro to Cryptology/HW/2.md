> [!problem|noicon] # 1.43
> Consider the affine cipher with key $k=(k_1, k_2)$, whose encryption and decryption functions are given by
> - $e_k(m) = k_1 \cdot m + k_2 \pmod p$
> - $d_k(c) = k_1' \cdot (c-k_2) \pmod p$ where $k_1' = k_1^{-1} \pmod p$.
> 
> **(a)** Let $p=541$ and let the key be $(34, 71)$. Encrypt the message $m=204$. Decrypt the ciphertext $c=431$.
> 
> **(b)** Assuming that $p$ is public knowledge, explain why the affine cipher is vulnerable to a chosen plaintext attack. How many plaintext/ciphertext pairs are likely to be needed in order to recover the private key?
> 
> **(c)** Alice and Bob decide to use the prime $p = 601$ for their affine cipher. The value of $p$ is public knowledge, and Eve intercepts the ciphertexts $c_1=324$ and $c_2=381$ and also manages to find out that the corresponding plaintexts are $m_1=387$ and $m_2=491$. Determine the private key and then use it to encrypt the message $m_3=173$.
> 
> **(d)** Suppose now that $p$ is not public knowledge. Is the affine cipher still vulnerable to a known plaintext attack? If so, how many plaintext/ciphertext pairs are likely to be needed in order to recover the private key?

**(a)** $e_k(204) = 34 \cdot 204 + 71 \equiv 515 \pmod {541}$. $34^{-1} \equiv 366 \pmod {541}$, and $d_k(431) = 366 \cdot(431 - 71) \equiv 297 \pmod {541}$.

**(b)** With only two plaintext/ciphertext pairs, we can explicitly solve for $k_1$ and $k_2$ as shown below.

**(c)** Working $\text{mod } 601$, we have $324 \equiv k_1 \cdot 387 + k_2$ and $381 \equiv k_1 \cdot 491 + k_2$. Subtracting yields $104 k_1 \equiv 57$, and $104^{-1} \equiv 549$, so we can multiply both sides by $549$ to get $k_1 \equiv 41$, from which it follows $k_2 \equiv 83$. Then $e_k(173) = 41 \cdot 173 + 83 \equiv 565$.

**(d)** If we can find a collision (that is, $m_1 \neq m_2$ such that $c_1 = c_2$) then we know $p \mid k_1 (m_2 - m_1)$. It is reasonable to assume that $p\not \mid k_1$, so $p \mid m_2 - m_1$. If we have a third plaintext we can then check the prime divisors of $m_2 - m_1$. Without a collision, $p$ may be arbitrarily large and it could be impossible to tractably solve for $k_1$ or $k_2$.

> [!problem|noicon] # 1.47
> Alice and Bob choose a key space $\mathcal{K}$ containing $2^{56}$ keys. Eve builds a special purpose computer that can check $10^{10}$ keys per second.
> 
> **(a)** How many days does it take Eve to check half the keys in $\mathcal{K}$?
> 
> **(b)** Alice and Bob replace their key space with a larger set containing $2^B$ keys. How large should Alice and Bob choose $B$ in order to force Eve's computer to spend 100 years checking half the keys?

**(a)** That is, $10^{10}x = 2^{55}$, so roughly 3.6 million seconds, or 41-42 days.

**(b)** 100 years $\approx 3.2 \cdot 10^9$ seconds, so $B \approx \log_2(3.2 \cdot 10^{19}) + 1 \approx 66$.